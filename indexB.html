<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <title>投資策略追蹤 App</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 900px; margin: auto; padding: 20px; }
    nav { margin-bottom: 20px; }
    nav button { margin-right: 10px; padding: 8px 15px; }
    section { display: none; }
    section.active { display: block; }
    label, select, input { display: block; margin: 10px 0 5px; }
    table { width: 100%; border-collapse: collapse; margin-top: 15px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    #summary { margin-top: 20px; }
  </style>
</head>
<body>
  <h1>投資策略追蹤 App</h1>
  <nav>
    <button onclick="showPage('record')">買賣記錄</button>
    <button onclick="showPage('stats')">投報率統計</button>
    <button onclick="showPage('tech')">技術分析</button>
  </nav>

  <section id="record" class="active">
    <h2>買賣記錄</h2>
    <form id="tradeForm">
      <label for="tradeDate">日期</label>
      <input type="date" id="tradeDate" required />
      <label for="tradeType">買/賣</label>
      <select id="tradeType" required>
        <option value="">請選擇</option>
        <option value="buy">買入</option>
        <option value="sell">賣出</option>
      </select>
      <label for="symbol">標的</label>
      <input type="text" id="symbol" placeholder="輸入股票代號" required />
      <label for="shares">股數</label>
      <input type="number" id="shares" min="1" required />
      <button type="submit">新增記錄</button>
    </form>

    <h3>買賣列表</h3>
    <table id="tradeTable">
      <thead>
        <tr><th>日期</th><th>類型</th><th>標的</th><th>股數</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>

  <section id="stats">
    <h2>投報率統計</h2>
    <div id="summary">尚無資料</div>
  </section>

  <section id="tech">
    <h2>技術分析</h2>
    <p>可整合外部API或自行開發圖表，示意內容略。</p>
  </section>

  <script>
    const tradeForm = document.getElementById('tradeForm');
    const tradeTableBody = document.querySelector('#tradeTable tbody');
    const summaryDiv = document.getElementById('summary');
    let trades = [];

    // 切換分頁
    function showPage(pageId) {
      document.querySelectorAll('section').forEach(sec => sec.classList.remove('active'));
      document.getElementById(pageId).classList.add('active');
      if(pageId === 'stats') calculateStats();
    }

    // 新增買賣記錄
    tradeForm.addEventListener('submit', e => {
      e.preventDefault();
      const date = tradeForm.tradeDate.value;
      const type = tradeForm.tradeType.value;
      const symbol = tradeForm.symbol.value.toUpperCase();
      const shares = Number(tradeForm.shares.value);

      trades.push({ date, type, symbol, shares });
      updateTradeTable();
      tradeForm.reset();
    });

    // 更新記錄列表呈現
    function updateTradeTable() {
      tradeTableBody.innerHTML = '';
      trades.forEach(trade => {
        const row = document.createElement('tr');
        row.innerHTML = `<td>${trade.date}</td><td>${trade.type}</td><td>${trade.symbol}</td><td>${trade.shares}</td>`;
        tradeTableBody.appendChild(row);
      });
    }

    // 計算並顯示投報率統計
    function calculateStats() {
      if(trades.length === 0) {
        summaryDiv.textContent = '尚無資料';
        return;
      }
      // 簡易累積買入股數計算示意（此處可進一步結合股價資料做投報率計算）
      let summary = {};
      trades.forEach(t => {
        let sign = t.type === 'buy' ? 1 : -1;
        if (!summary[t.symbol]) summary[t.symbol] = 0;
        summary[t.symbol] += sign * t.shares;
      });

      let html = '<table><thead><tr><th>標的</th><th>淨持股數</th></tr></thead><tbody>';
      for(let sym in summary) {
        html += `<tr><td>${sym}</td><td>${summary[sym]}</td></tr>`;
      }
      html += '</tbody></table>';
      summaryDiv.innerHTML = html;
    }
  </script>
</body>
</html>
